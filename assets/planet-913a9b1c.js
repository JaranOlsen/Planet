import{W as Kt,P as Qt,O as en,S as tn,V as L,R as nn,a as C,b as z,B as _,c as j,T as P,s as sn,d as an,e as on,f as rn,g as ln,h as cn,i as dn,j as un,k as hn,F as D,l as G,m as te,M as B,n as je,o as ot,p as it,D as rt,q as Me,A as lt,r as fn,t as Z,u as ct,v as K,w as dt,x as Be,G as pn,y as mn,z as ut,C as gn,E as De,L as xn,H as fe,I as yn,J as wn,K as vn,N as Sn,Q as V,U as Ge,X as be,Y as ht,Z as Xe,_ as A,$ as ze,a0 as Ue,a1 as Mn,a2 as I,a3 as bn,a4 as zn,a5 as $e,a6 as Ee,a7 as ye,a8 as oe,a9 as Je,aa as Ye,ab as Pn,ac as Te,ad as Ln,ae as Rn,af as we,ag as In,ah as Bn,ai as ft,aj as qn,ak as ce,al as Cn,am as En,an as Tn}from"./sign-a37302a0.js";import{d as _n,n as On,r as An,c as jn,a as Dn,b as Gn,e as Fn,f as kn,G as Vn,V as Wn,X as Hn,g as Nn}from"./clouds4k-899236db.js";const Xn="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles",Un="generic-trigger",pt=document.querySelector("#c"),v=new Kt({canvas:pt,antialias:!0});v.setPixelRatio(window.devicePixelRatio);function $n(s){const e=s.domElement,t=e.clientWidth,n=e.clientHeight,a=e.width!==t||e.height!==n;return a&&s.setSize(t,n,!1),a}const Jn=50,Yn=2,Zn=.1,Kn=2e3,l=new Qt(Jn,Yn,Zn,Kn);l.position.z=500;const T=new en(l,pt);T.enablePan=!1;T.maxDistance=1e3;T.minDistance=5.2;T.zoomSpeed=.3;T.rotateSpeed=.3;T.target.set(0,0,0);T.update();const F=new tn,Se=new L,J=new nn,Qn=new ft;new ft;let u=[],d=null,E=null,Pe=null,mt=null,g=null,y=[],_e=!0,R=!1,ie=new C(l.position.x,l.position.y,l.position.z);const ve=new C(0,0,0),q=new z;let gt=!1;const x=new Mn;x.onStart=function(s,e,t){};const es=document.getElementById("progress-bar");x.onProgress=function(s,e,t){es.value=e/t*100};const ts=document.querySelector(".progress-bar-container");x.onLoad=function(){ts.style.display="none"};x.onError=function(s){console.log("There was an error loading "+s)};const Le=document.getElementById("enableVRbutton");Le.addEventListener("click",()=>{Le.style.display="none",gt=!0});async function ns(){navigator.xr.isSessionSupported("immersive-vr").then(s=>{if(s){const e=Wn.createButton(v);document.body.appendChild(e),as()}})}gt==!0&&ns();function ss(){window.dolly=new z,window.dummyCam=new z,window.workingMatrix=new qn,window.buttonStates={},window.gamepadIndices="",window.info={},window.controllers={},window.elapsedTime=0,window.dollyLat=90,window.dollyLng=180,window.dollyRadius=8,window.XRinSession=!1}function as(){v.xr.enabled=!0,ss(),l.position.set(0,1.6,0);const s=I(dollyLat,dollyLng,dollyRadius);dolly.position.set(s.x,s.y-1.6,s.z),dolly.add(l),F.add(dolly),l.add(dummyCam),v.xr.getController(0).addEventListener("connected",os);const t=new Hn,n=new _().setFromPoints([new C(0,0,0),new C(0,0,-1)]),a=new bn(n);a.scale.z=0,controllers={},controllers.right=Ze(0,a,t),controllers.left=Ze(1,a,t)}function os(s){Re.style.display="none",Ie.style.display="none",Fe.style.display="none",info={},Nn(s.data,Xn,Un).then(({profile:e,assetPath:t})=>{console.log(JSON.stringify(e)),info.name=e.profileId,info.targetRayMode=s.data.targetRayMode,Object.entries(e.layouts).forEach(([n,a])=>{const o={};Object.values(a.components).forEach(f=>{o[f.rootNodeName]=f.gamepadIndices}),info[n]=o}),is(info.right),console.log(JSON.stringify(info)),rs(info)})}function is(s){buttonStates={},gamepadIndices=s,Object.keys(s).forEach(e=>{e.indexOf("touchpad")!=-1||e.indexOf("thumbstick")!=-1?buttonStates[e]={button:0,xAxis:0,yAxis:0}:buttonStates[e]=0})}function rs(s){if(s.right!==void 0){const e=v.xr.getController(0);let t=!1,n=!1;Object.keys(s.right).forEach(a=>{a.indexOf("trigger")!=-1&&(t=!0),a.indexOf("squeeze")!=-1&&(n=!0)}),t&&(e.addEventListener("selectstart",Ke),e.addEventListener("selectend",Qe)),n&&(e.addEventListener("squeezestart",et),e.addEventListener("squeezeend",tt)),e.addEventListener("disconnected",nt)}if(s.left!==void 0){const e=v.xr.getController(1);let t=!1,n=!1;Object.keys(s.left).forEach(a=>{a.indexOf("trigger")!=-1&&(t=!0),a.indexOf("squeeze")!=-1&&(n=!0)}),t&&(e.addEventListener("selectstart",Ke),e.addEventListener("selectend",Qe)),n&&(e.addEventListener("squeezestart",et),e.addEventListener("squeezeend",tt)),e.addEventListener("disconnected",nt)}}function Ze(s,e,t){const n=v.xr.getController(s);n.userData.selectPressed=!1,n.userData.index=s,e&&n.add(e.clone()),dolly.add(n);let a;return t&&(a=v.xr.getControllerGrip(s),a.add(t.createControllerModel(a)),dolly.add(a)),{controller:n,grip:a}}function Ke(){console.log("select"),this.userData.selectPressed=!0}function Qe(){this.children[0].scale.z=0,this.userData.selectPressed=!1,this.userData.selected=void 0,console.log("selectend")}function et(){this.userData.squeezePressed=!0,this.userData.selected!==void 0&&(this.attach(this.userData.selected),this.userData.attachedObject=userData.selected),console.log("squeeze")}function tt(){this.userData.squeezePressed=!1,this.userData.attachedObject!==void 0&&(room.attach(this.userData.attachedObject),this.userData.attachedObject=void 0),console.log("squeezeend")}function nt(){const s=userData.index;if(console.log(`Disconnected controller ${s}`),controllers){const e=s==0?controllers.right:controllers.left;if(e){if(e.controller){const t=e.controller;for(;t.children.length>0;)t.remove(t.children[0]);dolly.remove(t)}e.grip&&dolly.remove(e.grip)}}}function ls(s){if(s.userData.selectPressed){s.children[0].scale.z=10,workingMatrix.identity().extractRotation(s.matrixWorld),J.ray.origin.setFromMatrixPosition(s.matrixWorld),J.ray.direction.set(0,0,-1).applyMatrix4(workingMatrix);const e=J.intersectObjects(ce);if(e.length>0){E=e[0].object;const t=ce.findIndex(a=>a==e[0].object),n=V[t][6];n>0&&(de=document.querySelector(`.carousel.s${n}`),de.style.display="block"),xrSession.end().then(()=>xrSession=null)}}}function cs(){const e=v.xr.getSession().inputSources[0];if(e&&e.gamepad&&gamepadIndices&&buttonStates){const t=e.gamepad;XRinSession=!0;try{Object.entries(buttonStates).forEach(([n,a])=>{const o=gamepadIndices[n].button;if(n.indexOf("touchpad")!=-1||n.indexOf("thumbstick")!=-1){const f=gamepadIndices[n].xAxis,w=gamepadIndices[n].yAxis;buttonStates[n].button=t.buttons[o].value,buttonStates[n].xAxis=t.axes[f].toFixed(2),buttonStates[n].yAxis=t.axes[w].toFixed(2)}else buttonStates[n]=t.buttons[o].value})}catch{console.warn("An error occurred setting the ui")}}}let Oe=!1;const pe=document.getElementById("introTune");pe.preload="auto";pe.currentTime=0;pe.volume=1;const st=pe.duration,Re=document.getElementById("playbutton"),Fe=document.getElementById("credits");Re.addEventListener("click",()=>{pe.play(),Oe=!0,Re.style.display="none",Ie.style.display="none",Le.style.display="none",Fe.style.display="none"});const Ie=document.getElementById("skipbutton");Ie.addEventListener("click",()=>{Re.style.display="none",Ie.style.display="none",Le.style.display="none",Fe.style.display="none",l.position.z=15});let de;const ds=document.querySelectorAll("[data-carousel-button]");ds.forEach(s=>{s.addEventListener("click",()=>{if(document.querySelector(".carousel"),s.dataset.carouselButton==="exit")de.style.display="none";else{const e=s.dataset.carouselButton==="next"?1:-1,t=s.closest("[data-carousel]").querySelector("[data-slides]"),n=t.querySelector("[data-active]");let a=[...t.children].indexOf(n)+e;t.children[a].dataset.active=!0,delete n.dataset.active}})});const us=document.querySelectorAll("[data-menu-button]");us.forEach(s=>{s.addEventListener("click",()=>{if(document.querySelector(".carousel"),s.dataset.menuButton==="menu"){const e=s.closest("[data-carousel]").querySelector("[data-slides]"),t=e.querySelector("[data-active]"),n=e.querySelector("[menu]");let a=[...e.children].indexOf(n);e.children[a].dataset.active=!0,delete t.dataset.active}if(s.dataset.menuButton==="definition"){const e=s.closest("[data-carousel]").querySelector("[data-slides]"),t=e.querySelector("[data-active]"),n=e.querySelector("[definition]");let a=[...e.children].indexOf(n);e.children[a].dataset.active=!0,delete t.dataset.active}if(s.dataset.menuButton==="exercise"){const e=s.closest("[data-carousel]").querySelector("[data-slides]"),t=e.querySelector("[data-active]"),n=e.querySelector("[exercise]");let a=[...e.children].indexOf(n);e.children[a].dataset.active=!0,delete t.dataset.active}if(s.dataset.menuButton==="theory"){const e=s.closest("[data-carousel]").querySelector("[data-slides]"),t=e.querySelector("[data-active]"),n=e.querySelector("[theory]");let a=[...e.children].indexOf(n);e.children[a].dataset.active=!0,delete t.dataset.active}if(s.dataset.menuButton==="media"){const e=s.closest("[data-carousel]").querySelector("[data-slides]"),t=e.querySelector("[data-active]"),n=e.querySelector("[media]");let a=[...e.children].indexOf(n);e.children[a].dataset.active=!0,delete t.dataset.active}})});const hs=document.querySelectorAll("[data-nav-button]");hs.forEach(s=>{s.addEventListener("click",()=>{if(document.querySelector(".carousel"),s.dataset.navButton==="one"){const e=s.closest("[data-carousel]").querySelector("[data-slides]"),t=e.querySelector("[data-active]"),n=e.querySelector("[one]");let a=[...e.children].indexOf(n);e.children[a].dataset.active=!0,delete t.dataset.active}if(s.dataset.navButton==="two"){const e=s.closest("[data-carousel]").querySelector("[data-slides]"),t=e.querySelector("[data-active]"),n=e.querySelector("[two]");let a=[...e.children].indexOf(n);e.children[a].dataset.active=!0,delete t.dataset.active}if(s.dataset.navButton==="three"){const e=s.closest("[data-carousel]").querySelector("[data-slides]"),t=e.querySelector("[data-active]"),n=e.querySelector("[three]");let a=[...e.children].indexOf(n);e.children[a].dataset.active=!0,delete t.dataset.active}if(s.dataset.navButton==="four"){const e=s.closest("[data-carousel]").querySelector("[data-slides]"),t=e.querySelector("[data-active]"),n=e.querySelector("[four]");let a=[...e.children].indexOf(n);e.children[a].dataset.active=!0,delete t.dataset.active}if(s.dataset.navButton==="five"){const e=s.closest("[data-carousel]").querySelector("[data-slides]"),t=e.querySelector("[data-active]"),n=e.querySelector("[five]");let a=[...e.children].indexOf(n);e.children[a].dataset.active=!0,delete t.dataset.active}})});const xt=new _,yt=new _,wt=new _,vt=new _,St=new _,Mt=new _,bt=new _,zt=new _,Pt=new _,fs=new j({size:5,map:new P(x).load(sn),transparent:!0,fog:!1}),ps=new j({size:5,map:new P(x).load(an),transparent:!0,fog:!1}),ms=new j({size:5,map:new P(x).load(on),transparent:!0,fog:!1}),gs=new j({size:5,map:new P(x).load(rn),transparent:!0,fog:!1}),xs=new j({size:5,map:new P(x).load(ln),transparent:!0,fog:!1}),ys=new j({size:5,map:new P(x).load(cn),transparent:!0,fog:!1}),ws=new j({size:5,map:new P(x).load(dn),transparent:!0,fog:!1}),vs=new j({size:5,map:new P(x).load(un),transparent:!0,fog:!1}),Ss=new j({size:5,map:new P(x).load(hn),transparent:!0,fog:!1}),Lt=[];for(let s=0;s<5e3;s++){const e=(Math.random()-.5)*2e3,t=(Math.random()-.5)*2e3,n=(Math.random()-.5)*2e3;Math.abs(e)+Math.abs(t)+Math.abs(n)>400&&Lt.push(e,t,n)}const Rt=[];for(let s=0;s<1e3;s++){const e=(Math.random()-.5)*2e3,t=(Math.random()-.5)*2e3,n=(Math.random()-.5)*2e3;Math.abs(e)+Math.abs(t)+Math.abs(n)>400&&Rt.push(e,t,n)}const It=[];for(let s=0;s<500;s++){const e=(Math.random()-.5)*2e3,t=(Math.random()-.5)*2e3,n=(Math.random()-.5)*2e3;Math.abs(e)+Math.abs(t)+Math.abs(n)>400&&It.push(e,t,n)}const Bt=[];for(let s=0;s<100;s++){const e=(Math.random()-.5)*2e3,t=(Math.random()-.5)*2e3,n=(Math.random()-.5)*2e3;Math.abs(e)+Math.abs(t)+Math.abs(n)>400&&Bt.push(e,t,n)}const qt=[];for(let s=0;s<25;s++){const e=(Math.random()-.5)*2e3,t=(Math.random()-.5)*2e3,n=(Math.random()-.5)*2e3;Math.abs(e)+Math.abs(t)+Math.abs(n)>400&&qt.push(e,t,n)}const Ct=[];for(let s=0;s<1e3;s++){const e=(Math.random()-.5)*2e3,t=(Math.random()-.5)*2e3,n=(Math.random()-.5)*2e3;Math.abs(e)+Math.abs(t)+Math.abs(n)>400&&Ct.push(e,t,n)}const Et=[];for(let s=0;s<500;s++){const e=(Math.random()-.5)*2e3,t=(Math.random()-.5)*2e3,n=(Math.random()-.5)*2e3;Math.abs(e)+Math.abs(t)+Math.abs(n)>400&&Et.push(e,t,n)}const Tt=[];for(let s=0;s<100;s++){const e=(Math.random()-.5)*2e3,t=(Math.random()-.5)*2e3,n=(Math.random()-.5)*2e3;Math.abs(e)+Math.abs(t)+Math.abs(n)>400&&Tt.push(e,t,n)}const _t=[];for(let s=0;s<25;s++){const e=(Math.random()-.5)*2e3,t=(Math.random()-.5)*2e3,n=(Math.random()-.5)*2e3;Math.abs(e)+Math.abs(t)+Math.abs(n)>400&&_t.push(e,t,n)}xt.setAttribute("position",new D(Lt,3));yt.setAttribute("position",new D(Rt,3));wt.setAttribute("position",new D(It,3));vt.setAttribute("position",new D(Bt,3));St.setAttribute("position",new D(qt,3));Mt.setAttribute("position",new D(Ct,3));bt.setAttribute("position",new D(Et,3));zt.setAttribute("position",new D(Tt,3));Pt.setAttribute("position",new D(_t,3));const Ms=new G(xt,fs),bs=new G(yt,ps),zs=new G(wt,ms),Ps=new G(vt,gs),Ls=new G(St,xs),Rs=new G(Mt,ys),Is=new G(bt,ws),Bs=new G(zt,vs),qs=new G(Pt,Ss);F.add(Ms,bs,zs,Ps,Ls,Rs,Is,Bs,qs);const ne=new z;F.add(ne);const me=new z,ge=new z,xe=new z,se=new z;me.rotation.y=-Math.PI/2.5;me.rotation.x=.15;ge.rotation.y=2*Math.PI/16;ge.rotation.x=.22;xe.rotation.y=2*Math.PI/2;xe.rotation.x=.31;se.rotation.y=5*Math.PI/3;se.rotation.x=-.41;ne.add(me);ne.add(ge);ne.add(xe);ne.add(se);const W=new P(x);let Cs=W.load(_n);const Ot=new te(5,250,250);Ot.computeBoundingSphere();const S=new B(Ot,new je({map:Cs,normalMap:W.load(On),roughnessMap:W.load(An),normalScale:new L(1,1),metalness:0,roughness:.85,flatShading:!1,side:ot}));F.add(S);const Es=new it({map:W.load(jn),transparent:!0,side:rt,opacity:.8}),At=new B(new te(5.04,50,50),Es);S.add(At);const jt=new B(new te(5,500,500),new Me({vertexShader:Dn,fragmentShader:Gn,blending:lt}));jt.position.set(0,0,0);S.add(jt);const ke=new B(new te(5.3,50,50),new Me({vertexShader:Fn,fragmentShader:kn,blending:lt,side:fn,transparent:!0,depthWrite:!1}));ke.position.set(0,0,0);ke.scale.set(1.2,1.2,1.2);S.add(ke);const ee=new z;S.add(ee);for(let s=0;s<Z.length;s++)ct(Z[s].src,Z[s].lat,Z[s].lng-180,Z[s].size/500,Z[s].radius,ee);for(let s=0;s<K.length;s++)ct(K[s].src,K[s].lat,K[s].lng-180,K[s].size/500,K[s].radius,q);dt(V,ee,5);dt(be,q,7);const Dt=1e-4,Ve=3,Gt=.03,Ft=5.01,ue=new z;S.add(ue);let kt=ue;Be(V,Ge,Dt,Ve,Gt,Ft,kt,!1);Be(V,zn,Dt,Ve,Gt,Ft,kt,!0);const We=new z;q.add(We);let Ts=We;Be(be,ht,2e-4,Ve,.1,7.01,Ts,!1);let he=new z;ee.add(he);he.position.set(0,-5.05,0);const _s=new pn(x);_s.load(mn,function(s){const e=s.scene;he.add(e),e.scale.set(5,5,5),e.rotation.y+=Math.PI/2,e.rotation.x+=Math.PI/3},function(s){},function(s){console.log("An error happened")});const Vt=5,Os=new te(Vt,50,50),As=new ut({map:new P(x).load(gn)}),le=new B(Os,As);le.position.set(0,0,490);se.add(le);const He=new De(16777215,1.2,2e3);He.position.set(le.position.x,le.position.y,le.position.z-Vt*1.5);se.add(He);const js=W.load("https://jaranolsen.github.io/Planet/sunflare.webp"),qe=W.load("https://jaranolsen.github.io/Planet/lensflare.webp"),Y=new xn;Y.position.set(0,0,0);Y.addElement(new fe(js,2560,0));Y.addElement(new fe(qe,60,.6));Y.addElement(new fe(qe,70,.7));Y.addElement(new fe(qe,120,.9));Y.addElement(new fe(qe,70,1));He.add(Y);class Ne{constructor(e,t,n,a,o,f){this.radius=e,this.texture=t,this.z=n,this.rotation=a,this.pivot=o,this.intensity=f}}let Ds=new Ne(1.5,Cn,110,-5e-4,me,.1),Gs=new Ne(2.5,En,190,-3e-4,ge,.05),Fs=new Ne(1,Tn,250,-1e-4,xe,.005),$=[Ds,Gs,Fs];for(let s=0;s<$.length;s++){const e=new B(new te($[s].radius,50,50),new je({map:new P(x).load($[s].texture),metalness:0,flatShading:!1,side:ot}));e.position.set($[s].z,0,0),$[s].pivot.add(e);const t=new De(16777215,$[s].intensity);t.position.set($[s].z,0,0),e.add(t)}let Ae=!1;function ks(){Ae=!0,F.add(q);let s=7,e=9,t=[],n=[];for(let i=0;i<e;i++){t[i]=[],n[i]=[];for(let b=2*Math.PI*i;b<=2*Math.PI*(i+1.0000001);b+=Math.PI/128){let N=Math.sin(b/(e*2)),X=N*s*Math.cos(b),U=N*s*Math.sin(b),ae=s/(e*Math.PI)*b;t[i].push(new C(X,ae-s,U)),i==0?b>2*Math.PI*i+(2*Math.PI*(i+1.0000001)-2*Math.PI*i)*.98&&n[i].push(new C(X,ae-s,U)):i<e?(b<2*Math.PI*i+(2*Math.PI*(i+1.0000001)-2*Math.PI*i)*.02&&n[i-1].push(new C(X,ae-s,U)),b>2*Math.PI*i+(2*Math.PI*(i+1.0000001)-2*Math.PI*i)*.98&&n[i].push(new C(X,ae-s,U))):b<2*Math.PI*i+(2*Math.PI*(i+1.0000001)-2*Math.PI*i)*.02&&n[i-1].push(new C(X,ae-s,U))}let p=new $e(t[i]);const O=new Ee(p,64,.01,10,!1);O.computeBoundingBox();const Ut=new Me({uniforms:{color1:{value:new ye(oe[40+i])},color2:{value:new ye(oe[40+i+1])},bboxMin:{value:O.boundingBox.min},bboxMax:{value:O.boundingBox.max}},vertexShader:Je,fragmentShader:Ye}),$t=new B(O,Ut);q.add($t);const Jt=new Ee(p,64,.12-i/70,10,!1),Yt=new ut({color:oe[40+i],transparent:!0,opacity:.6}),Zt=new B(Jt,Yt);if(q.add(Zt),q.rotation.set(0,0,0),i!==0){let b=new $e(n[i-1]);const N=new Ee(b,64,.15-i/70,10,!1);N.computeBoundingBox();const X=new Me({uniforms:{color1:{value:new ye(oe[40+i-1])},color2:{value:new ye(oe[40+i])},bboxMin:{value:N.boundingBox.min},bboxMax:{value:N.boundingBox.max}},vertexShader:Je,fragmentShader:Ye}),U=new B(N,X);q.add(U)}}const a=W.load(Pn);a.repeat.set(0,100),a.wrapT=Te,a.rotation=Math.PI/2;const o=W.load(Ln);o.repeat.set(1,100),o.wrapS=Te,o.wrapT=Te,o.rotation=Math.PI/2,o.offset.set(.5,0);const f=new Rn(6.05,.05,50,100),w=new je({alphaMap:a,transparent:!0,alphaTest:.5,map:o,emissive:16777215,emissiveMap:o,emissiveIntensity:.05,color:16777215,metalness:1,roughness:.7}),m=new B(f,w);m.rotation.x=Math.PI/2,m.position.y=2.34,q.add(m)}const Vs=100,r=3e-4,Ws=new it({color:12312012,side:rt}),H=new yn;H.moveTo(r*5,r*5);H.bezierCurveTo(r*5,r*5,r*4,0,0,0);H.bezierCurveTo(-r*6,0,-r*6,r*7,-r*6,r*7);H.bezierCurveTo(-r*6,r*11,-r*3,r*15.4,r*5,r*19);H.bezierCurveTo(r*12,r*15.4,r*16,r*11,r*16,r*7);H.bezierCurveTo(r*16,r*7,r*16,0,r*10,0);H.bezierCurveTo(r*7,0,r*5,r*5,r*5,r*5);const Ce=new wn(H);Ce.center=0;Ce.rotateZ(Math.PI/2);Ce.rotateY(Math.PI/2);class Hs{constructor(e,t){this.lat=e,this.lng=t,this.gutt=new B(Ce,Ws),this.pos=new L(e,t),this.velocity=new L(we(0,0),we(0,1)).setLength(.001),this.acceleration=new L,this.cartesianPosition=I(this.pos.x,this.pos.y,5.1),this.presentHeading,this.originalHeading,this.gutt.position.set(this.cartesianPosition.x,this.cartesianPosition.y,this.cartesianPosition.z),this.wander=new L(0,0),this.alignment=new L(0,0),this.cohesion=new L(0,0),this.separation=new L(0,0),this.avoidance=new L(0,0),S.add(this.gutt)}move(){this.originalHeading=Math.atan2(this.velocity.x,this.velocity.y),this.acceleration.set(0,0),this.alignment.multiplyScalar(c.alignment),this.cohesion.multiplyScalar(c.cohesion),this.separation.multiplyScalar(c.separation),this.acceleration.add(this.wander),this.acceleration.add(this.alignment),this.acceleration.add(this.cohesion),this.acceleration.add(this.separation),this.acceleration.add(this.avoidance),this.velocity.add(this.acceleration),this.velocity.clampLength(-c.max_speed,c.max_speed),this.velocity.setLength(c.max_speed),this.pos.add(this.velocity),this.pos.x<0&&(this.pos.x=Math.abs(this.pos.x),this.pos.y<180?this.pos.y+=180:this.pos.y-=180,this.velocity.x*=-1,this.velocity.y*=-1),this.pos.x>180&&(this.pos.x=180-(this.pos.x-180),this.pos.y<180?this.pos.y+=180:this.pos.y-=180,this.velocity.x*=-1,this.velocity.y*=-1),this.pos.y<0&&(this.pos.y=360+this.pos.y),this.pos.y>360&&(this.pos.y=this.pos.y-360),this.cartesianPosition=I(this.pos.x,this.pos.y,5.1),this.cartesianVelocity=I(this.velocity.x,this.velocity.y,5.1),this.presentHeading=Math.atan2(this.velocity.x,this.velocity.y),this.cp=new C,this.cp.set(this.cartesianPosition.x,this.cartesianPosition.y,this.cartesianPosition.z),this.gutt.lookAt(this.cp),this.gutt.rotateZ(this.presentHeading-this.originalHeading),this.gutt.position.set(this.cartesianPosition.x,this.cartesianPosition.y,this.cartesianPosition.z)}calculateWander(){this.wander.set(we(-1e-4,1e-4),we(-1e-4,1e-4)),this.wander.clampLength(-c.max_force,c.max_force)}calculateAlignment(){let e=0;this.alignment.set(0,0);for(let t=0;t<h.length;t++)h[t]!=this&&this.gutt.position.distanceTo(h[t].gutt.position)<c.alignment_perception_distance&&(this.alignment.add(h[t].velocity),e+=1);e>0&&(this.alignment.set(this.alignment.x/e,this.alignment.y/e),this.alignment.sub(this.velocity),this.alignment.clampLength(-c.max_force,c.max_force))}calculateCohesion(){let e=0;this.cohesion.set(0,0);for(let t=0;t<h.length;t++)h[t]!=this&&this.gutt.position.distanceTo(h[t].gutt.position)<c.cohesion_perception_distance&&(this.cohesion.add(h[t].pos),e+=1);e>0&&(this.cohesion.set(this.cohesion.x/e,this.cohesion.y/e),this.cohesion.sub(this.pos),this.cohesion.clampLength(-c.max_force,c.max_force))}calculateSeparation(){let e=0;this.separation.set(0,0);for(let t=0;t<h.length;t++)if(h[t]!=this&&this.gutt.position.distanceTo(h[t].gutt.position)<c.separation_perception_distance){let n=new L(this.pos.x-h[t].pos.x,this.pos.y-h[t].pos.y);n.divideScalar(this.gutt.position.distanceTo(h[t].gutt.position)),this.separation.add(n),e+=1}e>0&&(this.separation.set(this.separation.x/e,this.separation.y/e),this.separation.clampLength(-c.max_force,c.max_force))}calculateTemperature(){this.avoidance.set(0,0),this.pos.x<40&&(this.avoidance.set(Math.pow(40-this.pos.x,2)/1e5,0),this.avoidance.clampLength(-c.max_force,c.max_force)),this.pos.x>140&&(this.avoidance.set(-Math.pow(140-this.pos.x,2)/1e5,0),this.avoidance.clampLength(-c.max_force,c.max_force))}}let h=[];for(let s=0;s<Vs;s++){let e=In(40,140,5),t=Bn(0,359);h.push(new Hs(e,t))}const Wt=new Vn;let c={alignment:.016,alignment_perception_distance:.435,cohesion:.754,cohesion_perception_distance:.887,separation:.765,separation_perception_distance:.225,max_force:.0029,max_speed:.01};const k=Wt.addFolder("parameters");k.add(c,"alignment",0,.1,1e-4);k.add(c,"alignment_perception_distance",0,1,.001);k.add(c,"cohesion",0,1,.001);k.add(c,"cohesion_perception_distance",0,1,.001);k.add(c,"separation",0,1,.001);k.add(c,"separation_perception_distance",0,1,.001);k.add(c,"max_force",0,.01,1e-4);k.add(c,"max_speed",0,.1,.001);k.close();Wt.hide();const Ns=new vn(16777215,.02);F.add(Ns);const M=new Sn(15723480,0);M.penumbra=.8;M.angle=Math.PI/8;F.add(M);let Q=.5;const Ht=new De(16777215,.5);Ht.position.set(0,0,0);S.add(Ht);u.push([V,V.length,Ge,ue,5.01]);u.push([be,u[u.length-1][1]+be.length,ht,We,7.01]);function Xs(){J.setFromCamera(Se,l);const s=J.intersectObjects(ce);if(s.length==0)for(let e=0;e<A.length;e++)A[e].pin.material.color.set(A[e].originalColor);for(let e=0;e<s.length;e++)s[e].object.material.color.set(16711680)}document.addEventListener("keyup",Us,!1);function Us(s){const e=s.which;if(e==65&&(y.length=0),e==90&&g!==null&&(y.indexOf(g)==-1&&y.push(g),console.log(y)),e==67&&(_e==!0?(S.remove(ee),S.remove(ue),_e=!1):(S.add(ee),S.add(ue),_e=!0)),e==70&&(R==!0?R=!1:R=!0),e==76&&(M.intensity==0?M.intensity=Q:M.intensity==Q?M.intensity=Q*2:M.intensity==Q*2?M.intensity=Q*3:M.intensity==Q*3&&(M.intensity=0)),e==81){let t="";const n=u[d][0];for(let a=0;a<n.length;a++)t=t+'    {id: "'+n[a].id+'", text: '+JSON.stringify(n[a].text)+", lat: "+n[a].lat+", lng: "+n[a].lng+", color: "+n[a].color+", size: "+n[a].size+", slides: "+n[a].slides+`},
`;console.log(t)}if(e==83&&(Ae==!1?ks():(Ae=!1,F.remove(q))),e==87){const t=[u[d][0],u[d][2],u[d][3],u[d][4]];t[2].clear();const n=2e-4,a=3,o=.03;Be(t[0],t[1],n,a,o,t[3],t[2])}if(e==187){let t=0,n=0,a={context:u[d][0]},o;d>0?o=u[d-1][1]:o=0,g&&(t=A[g].originalSize),a.context[g-o].size+=5,n=a.context[g-o].size,E.scale.set(n/t,n/t,n/t),Pe.scale.set(n/t,n/t,n/t)}if(e==189){let t=0,n=0,a={context:u[d][0]},o;d>0?o=u[d-1][1]:o=0,g&&(t=A[g].originalSize),a.context[g-o].size-=5,n=a.context[g-o].size,E.scale.set(n/t,n/t,n/t),Pe.scale.set(n/t,n/t,n/t)}}document.addEventListener("keydown",$s,!1);function $s(s){const e=s.which;if(y.length>0){const t={context:u[d][0],length:u[d][1],radius:u[d][4]};for(let n=0;n<y.length;n++)if(e==38||e==40||e==37||e==39){let a=Xe(A[y[n]].pin.position.x,A[y[n]].pin.position.y,A[y[n]].pin.position.z);e==38?(R&&(a.lat-=.4),a.lat-=.1):e==40?(R&&(a.lat+=.4),a.lat+=.1):e==37?(R&&(a.lng-=.4),a.lng-=.1):e==39&&(R&&(a.lng+=.4),a.lng+=.1);const o=t.radius,f=t.radius+.04,w=t.radius+.05,m=I(a.lat,a.lng,o),i=I(a.lat,a.lng,f),p=I(a.lat,a.lng,w);A[y[n]].pin.position.set(m.x,m.y,m.z),ze[y[n]].box.position.set(i.x,i.y,i.z),ze[y[n]].tag.position.set(p.x,p.y,p.z),a=Ue(a.lat,a.lng-180);let O;d>0?O=u[d-1][1]:O=0,t.context[y[n]-O].lat=a.lat.toFixed(1),t.context[y[n]-O].lng=a.lng.toFixed(1)}}else if(E!=null){const t={context:u[d][0],length:u[d][1],radius:u[d][4]};if(e==38||e==40||e==37||e==39){let n=Xe(E.position.x,E.position.y,E.position.z);e==38?(R&&(n.lat-=.4),n.lat-=.1):e==40?(R&&(n.lat+=.4),n.lat+=.1):e==37?(R&&(n.lng-=.4),n.lng-=.1):e==39&&(R&&(n.lng+=.4),n.lng+=.1);const a=t.radius,o=t.radius+.04,f=t.radius+.05,w=I(n.lat,n.lng,a),m=I(n.lat,n.lng,o),i=I(n.lat,n.lng,f);E.position.set(w.x,w.y,w.z),Pe.position.set(m.x,m.y,m.z),mt.position.set(i.x,i.y,i.z),n=Ue(n.lat,n.lng-180);let p;d>0?p=u[d-1][1]:p=0,t.context[g-p].lat=n.lat.toFixed(1),t.context[g-p].lng=n.lng.toFixed(1)}}}const re=[];let at;const Js=document.querySelector("#fpsCounter"),Nt=document.createElement("div");function Xt(){window.requestAnimationFrame(()=>{const s=performance.now();for(;re.length>0&&re[0]<=s-1e3;)re.shift();re.push(s),at=re.length,Nt.textContent=at,Xt()})}Js.appendChild(Nt);Xt();V.length!==Ge.length&&console.log("ERROR: tagPlanetData.length !== tagPlanetConnections.length");function Ys(){v.setAnimationLoop(Zs)}function Zs(s){if(v.xr.isPresenting){const o=Qn.getDelta();if(controllers&&Object.values(controllers).forEach(f=>{ls(f.controller)}),elapsedTime===void 0&&(elapsedTime=0),elapsedTime+=o,elapsedTime>.3&&(cs(),elapsedTime=0),XRinSession==!0){const f=Number(buttonStates.xr_standard_thumbstick.xAxis),w=Number(buttonStates.xr_standard_thumbstick.yAxis);if(f!=0||w!=0||buttonStates.a_button!=0||buttonStates.b_button!=0){dollyLng+=f*2,dollyLat+=w,dollyRadius+=(.1*buttonStates.a_button-.1*buttonStates.b_button)*(dollyRadius-5);const m=I(dollyLat,dollyLng,dollyRadius);dolly.position.set(m.x,m.y-1.6,m.z)}}}if($n(v)){const o=v.domElement;l.aspect=o.clientWidth/o.clientHeight,l.updateProjectionMatrix()}for(let o=0;o<h.length;o++)h[o].calculateWander(),h[o].calculateAlignment(),h[o].calculateCohesion(),h[o].calculateSeparation(),h[o].calculateTemperature(),h[o].move();function e(o){Se.x=o.clientX/window.innerWidth*2-1,Se.y=-(o.clientY/window.innerHeight)*2+1}function t(o){J.setFromCamera(Se,l);const f=J.intersectObjects(ce);if(f.length>0){E=f[0].object,g=ce.findIndex(p=>p==f[0].object),Pe=ze[g].box,mt=ze[g].tag;const w=d;for(let p=0;p<100;p++)if(g<u[p][1]){d=p,d!==w&&(y.length=0);break}let m;d>0?m=u[d-1][1]:m=0;let i=u[d][0];if(l.position.distanceTo(E.position)<4&&i[g-m].slides!==void 0){const p=V[g].slides;de=document.querySelector(`.carousel.s${p}`),de.style.display="block"}}}window.addEventListener("pointermove",e),window.addEventListener("mouseup",t),document.addEventListener("touchstart",t),Xs(),v.render(F,l);const n=l.position,a=l.rotation;M.position.set(n.x,n.y,n.z),M.rotation.set(a.x,a.y,a.z),ne.rotation.y+=-1e-5,me.rotation.y+=-3e-4,ge.rotation.y+=-3e-5,xe.rotation.y+=-9e-6,se.rotation.y+=1e-4,At.rotation.y+=1e-5,l.position.z>15&&Oe==!0&&(l.position.z-=.0213*Math.pow(l.position.z-10,1.35)/st,S.rotation.y+=5e-4),l.position.z<-15&&Oe==!0&&(l.position.z+=.213*Math.pow(Math.abs(l.position.z)-10,1.35)/st,S.rotation.y+=5e-4),T.rotateSpeed=(l.position.distanceTo(ve)-5)/l.position.distanceTo(ve),T.zoomSpeed=(l.position.distanceTo(ve)-5)/l.position.distanceTo(ve)/3,he&&(ie.set(l.position.x,l.position.y,l.position.z),ie.normalize(),he.lookAt(ie.x,ie.y,ie.z)),T.update()}Ys();
